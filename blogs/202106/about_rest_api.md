---
title: 重新认识REST API
date: 2021-6-15
categories:
  - Code style
publish: true
---

> 本文译自[What is REST (restfulapi.net)](https://restfulapi.net/)，旨在重新认识REST。
>
> 为了帮助读者更好的理解REST，对其中的一些不必要的描述作了删节。

### 什么是REST

**RE**presentational **S**tate **T**ransfer，表征状态转移，缩写为REST，是一种分布式超媒体系统的架构风格。它由Roy Fielding于2000年在他的[论文](https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)中提出。

REST定义了六条规则，凡是遵守这六条规则的接口设计都能够称之为RESTful。

## RESTful API的六大原则

- **Client–server** – 通过分离UI和逻辑，提升了UI的跨平台可移植性；通过简化服务端组件，提升了服务端组件的可扩展性。
- **Stateless** – 每个请求都能够独立的被服务端理解，并且不能利用任何存储在服务器上的上下文；所以，会话状态始终存储在客户端中。
- **Cacheable** – 响应应当能够被标记为可缓存或不可缓存。
- **Uniform interface** – 接口应当遵循统一的标准。在REST中，有四个接口约束：
  - 资源标识
  - 表征式资源操纵
  - 自描述消息
  - 使用超媒体作应用程序的状态引擎
- **Layered system** – 系统架构可以由有结构的层级组成，这样就可以对组件的作用域进行限制，例如组件只能“看”到与他直接交互的那一层中的其他组件。
- **Code on demand (可选)** – REST允许客户端下载并执行远程代码。这减少了构建原型所需的特性数量。



## 资源

**资源**是REST中对信息的抽象。任何能够被命名的信息都是一个资源，例如文档或图片、临时服务等。REST使用资源标识符在不同的组件中识别资源。

资源在任意时刻的状态称为表征。表征由下列元素组成：

- 数据
- 元数据：描述数据的数据
- 超媒体链接：帮助客户端过渡到下一状态的资源

表征的数据格式称作**media type**（媒体类型），媒体类型指导一个表征的处理流程。一个符合标准的RESTful API看起来就像一个超链接一样。每一个可编址的信息单元都显式（例如一个带有id或属性的链接）或隐式（从媒体类型或表征结构派生）地含有一个地址。

另外，资源表征应当是自描述的：客户端不需要假定一个响应结果是员工信息还是设备信息。这种帮助客户端理解响应的信息应当被包含在媒体类型中。所以在生产实践中，你会写一些自定义的媒体类型，一般一个媒体类型对应一种资源类型。

> 每种媒体类型都对应了一种默认的消息处理模型。例如，`text/html`定义了应用于浏览器的渲染规则，而这与HTTP Method无关。



## 资源方法

REST中操纵资源所用的HTTP Method是另外一个需要注意的点。很多人将资源方法和**GET/PUT/POST/DELETE**这类具体的HTTP Methods联系到一起，这是错误的。

Roy Fielding 从未提及任何关于使用哪种HTTP方法的建议；REST强调的只是接口应该是统一的（Uniform interface）。如果你决定使用 HTTP POST 来更新资源（大多数人使用 HTTP PUT）没关系，你的接口依然是 RESTful 的。

理想情况下，改变资源状态所需的一切都应该是该资源的 API 响应的一部分——包括方法以及它们将在什么状态下离开表示。这意味着你的响应中应当包含一个links字段，里面包含了改变这个资源状态的链接。

另外，基于query string的 API 应该返回一个带有摘要信息的链接列表，而不是由原始资源的数组，因为query string不能替代资源标识。

> 例如：/book?id=1,2,3应当返回：
>
> ```json
> {
>     "data": [
>         {
>             "name": "book1",
>             "link": "https://......."
>             // no ISBN or other info
>         },
>         ...
>     ]
> }
> ```
>
> 而不是：
>
> ```json
> {
>     "data": [
>         {
>             "name": "book1",
>             "ISBN": "asdasdsada",
>             "author": "asddasdasda",
>             ...
>         },
>         ...
>     ]
> }
> ```



## REST和HTTP不是一回事！

很多人将REST和HTTP绑定在一起，但他们不是一回事。

广义的REST只是一种API结构的组织规范，和HTTP没有什么关联。不过由于REST在HTTP web系统中的应用最为广泛，现在REST API也可以指REST HTTP API。

简而言之，在 REST 架构风格中数据和功能被视为**资源**，并使用统一资源标识符 (URI) 进行访问，通过使用一组简单、完备的操作来处理资源。客户端和服务器通过使用标准化的接口和协议（通常是 HTTP）来交换资源的表示。

资源与其表示分离，可以以各种格式访问其内容，例如 HTML、XML、纯文本、PDF、JPEG、JSON 等。例如，有关资源的元数据可用于控制缓存、检测传输错误、协商适当的表示格式以及执行身份验证或访问控制。最重要的是，与资源的每次交互都是无状态的。

